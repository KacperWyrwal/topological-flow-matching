# @package _global_

defaults:
  - override /data: brain
  - override /frame: spectral
  - override /model: residual_nn
  - override /sde: topological_heat_bm
  - override /sde_solver: euler_maruyama
  - override /train/coupling: ot
  - _self_

# Training setup
train:
  num_epochs: 100
  early_stopping:
    enabled: true
    patience: 10

test:
  ratio: 0.2
  batch_size: null
  epoch_size: null

validation:
  ratio: 0.1
  batch_size: null
  epoch_size: null

# Plotting
plot:
  predictions:
    enabled: false  # 2D plot not applicable to brain by default

# Run and W&B
run:
  device: cpu
  dtype: float64
  mode: test
  use_wandb: true
  wandb:
    project: topological-flow-matching
    tags: [brain, topological, ot, test]

# Hydra sweeper config for random seed sweep
hydra:
  sweeper:
    _target_: hydra_plugins.hydra_optuna_sweeper.optuna_sweeper.OptunaSweeper
    direction: minimize
    n_trials: 11  # seeds 0-10
    n_jobs: 1
    params:
      run.seed: choice(0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10)

# Override run.seed to be swept
run:
  seed: ${hydra:runtime.choices.run.seed}
